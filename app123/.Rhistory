pi<-exp(x)/(1+exp(x))
y<-rep(1:n)
for (i in 1:n){
y[i]<-rbinom(1,1,pi[i])
}
m1=glm(y~x, family=binomial(link=logit))
u=exp(predict(m1, data.frame(x=x)))/(1+exp(predict(m1, data.frame(x=x))))
x<-runif(n,min=0,max=100)
x<--0.2+0.04*x
pi<-exp(x)/(1+exp(x))
x<-runif(n,min=0,max=100)
result<-function(n){
x<-runif(n,min=0,max=100)
x<--0.2+0.04*x
pi<-exp(x)/(1+exp(x))
y<-rep(1:n)
for (i in 1:n){
y[i]<-rbinom(1,1,pi[i])
}
m1=glm(y~x, family=binomial(link=logit))
u=exp(predict(m1, data.frame(x=x)))/(1+exp(predict(m1, data.frame(x=x))))
cor(y-u,u)
}
result(25)
result(25)
result(25)
result(25)
result(25)
result(100)
result<-function(n){
x<-runif(n,min=0,max=100)
x<--0.2+0.04*x
pi<-exp(x)/(1+exp(x))
y<-rep(1:n)
for (i in 1:n){
y[i]<-rbinom(1,1,pi[i])
}
m1=glm(y~x, family=binomial(link=logit))
u=exp(predict(m1, data.frame(x=x)))/(1+exp(predict(m1, data.frame(x=x))))
cor(y-u,u)
}
result(25)
result(100)
result(1000)
result(10000)
CORR=function(n){
x=runif(n,0,100)
y=NULL
for (i in 1:n){
a=exp(-2+0.04*x[i])
p=a/(1+a)
y=cbind(y,rbinom(1,1,p))
}
fm=glm(y[1,]~x, family=binomial(link=logit))
pre=predict(fm, data.frame(x=x))
u=exp(pre)/(1+exp(pre))
cor(y[1,]-u,u)
}
CORR(25)
CORR(100)
CORR(1000)
CORR(10000)
result<-function(n){
x<-runif(n,min=0,max=100)
x<--0.2+0.04*x
pi<-exp(x)/(1+exp(x))
y<-rep(1:n)
for (i in 1:n){
y[i]<-rbinom(1,1,pi[i])
}
m1=glm(y~x, family=binomial(link=logit))
u=exp(predict(m1, data.frame(x=x)))/(1+exp(predict(m1, data.frame(x=x))))
cor(y-u,u)
}
result(25)
result(100)
result(1000)
result(10000)
#3
y<-c(16/58, 9/90, 10/48, 13/57, 19/103, 20/57, 18/86, 17/112, 35/273, 55/64)
z<-c(12/113, 1/18, 2/14, 4/44, 9/208, 7/67, 9/29, 8/154)
y<-1/(1/y+1)
z<-1/(1/z+1)
lkhd=function(a,b,y)
{
prob=1
for (i in 1:length(y)){
prob=prob/beta(a,b)*y[i]^(a-1)*(1-y[i])^(b-1)
}
prob
}
alpha=seq(0.1,20,0.1);na=length(alpha)
beta=seq(0.1,50,0.1);nb=length(beta)
prior=function(a,b)
{
u<-a/(a+b)
s2<-u*(1-u)/(a+b+1)
prob = 1*1/(u*(1-u))
}
zy=matrix(0,na,nb)
for (i in 1:na){
zy[i,]=lkhd(alpha[i],beta,y)*prior(alpha[i],beta)
}
par(mfrow=c(1,2))
zy=zy/sum(zy*0.1*0.1)
contour(alpha,beta,zy, nlevels=10,
main="Contour plot of posterior Thetay",
xlim=c(0,10),ylim=c(0,40),xlab="alpha",ylab="beta")
alphaz=seq(0.1,20,0.1);na=length(alphaz)
betaz=seq(0.1,100,0.1);nb=length(betaz)
zz=matrix(0,na,nb)
for (i in 1:na){
zz[i,]=lkhd(alphaz[i],betaz,z)
}
zz=zz/sum(zz*0.1*0.1)
contour(alphaz,betaz,zz, nlevels=10,
main="Contour plot of posterior Thetaz",
xlim=c(0,10),ylim=c(0,80),xlab="alpha",ylab="beta")
amary=NULL
for (i in 1:nrow(zy)){
amary=cbind(amary,sum(zy[i,])*0.1)}
amary<-amary/sum(amary*0.1)
simu=matrix(0,1000,2)
#3
y<-c(16/58, 9/90, 10/48, 13/57, 19/103, 20/57, 18/86, 17/112, 35/273, 55/64)
z<-c(12/113, 1/18, 2/14, 4/44, 9/208, 7/67, 9/29, 8/154)
y<-1/(1/y+1)
z<-1/(1/z+1)
lkhd=function(a,b,y)
{
prob=1
for (i in 1:length(y)){
prob=prob/beta(a,b)*y[i]^(a-1)*(1-y[i])^(b-1)
}
prob
}
alpha=seq(0.1,20,0.1);na=length(alpha)
beta=seq(0.1,50,0.1);nb=length(beta)
prior=function(a,b)
{
u<-a/(a+b)
s2<-u*(1-u)/(a+b+1)
prob = 1*1/(u*(1-u))
}
#alpha=seq(0.1,100,0.1);na=length(alpha)
#beta=seq(0.1,100,0.1);nb=length(beta)
zy=matrix(0,na,nb)
for (i in 1:na){
zy[i,]=lkhd(alpha[i],beta,y)*prior(alpha[i],beta)
}
par(mfrow=c(1,2))
zy=zy/sum(zy*0.1*0.1)
contour(alpha,beta,zy, nlevels=10,
main="Contour plot of posterior Thetay",
xlim=c(0,10),ylim=c(0,40),xlab="alpha",ylab="beta")
alphaz=seq(0.1,20,0.1);na=length(alphaz)
betaz=seq(0.1,100,0.1);nb=length(betaz)
zz=matrix(0,na,nb)
for (i in 1:na){
zz[i,]=lkhd(alphaz[i],betaz,z)*prior(alphaz[i],betaz)
}
zz=zz/sum(zz*0.1*0.1)
contour(alphaz,betaz,zz, nlevels=10,
main="Contour plot of posterior Thetaz",
xlim=c(0,10),ylim=c(0,80),xlab="alpha",ylab="beta")
amary=NULL
for (i in 1:nrow(zy)){
amary=cbind(amary,sum(zy[i,])*0.1)}
amary<-amary/sum(amary*0.1)
simu=matrix(0,1000,2)
for (i in 1:1000){
a=sample(alpha,1,prob=amary)
b=sample(beta,1,prob=zy[which(alpha==a),]/sum(zn[which(alpha==a),]*0.1))
simu[i,]=c(a,b)
}
plot(simu[,2]~ simu[,1],
type="p",xlim=c(0,20),ylim=c(0,60),
xlab="alpha",ylab="beta",main = "Simulation of thetay")
amarz=NULL
for (i in 1:nrow(zz)){
amarz=cbind(amarz,sum(zz[i,])*0.1)}
amarz<-amarz/sum(amarz*0.1)
simu1=matrix(0,1000,2)
for (i in 1:1000){
a=sample(alphaz,1,prob=amarz)
b=sample(betaz,1,prob=zz[which(alphaz==a),]/sum(zz[which(alphaz==a),]*0.1))
simu1[i,]=c(a,b)
}
plot(simu1[,2]~ simu1[,1],
type="p",xlim=c(0,20),ylim=c(0,100),
xlab="alpha",ylab="beta",main = "Simulation of thetaz")
#(d)
uy<-simu[,1]/(simu[,1]+simu[,2])
uz<-simu1[,1]/(simu1[,1]+simu1[,2])
par(mfrow=c(1,1))
hist(uy-uz,breaks= 30)
simu=matrix(0,1000,2)
for (i in 1:1000){
a=sample(alpha,1,prob=amary)
b=sample(beta,1,prob=zy[which(alpha==a),]/sum(zn[which(alpha==a),]*0.1))
simu[i,]=c(a,b)
}
#3
y<-c(16/58, 9/90, 10/48, 13/57, 19/103, 20/57, 18/86, 17/112, 35/273, 55/64)
z<-c(12/113, 1/18, 2/14, 4/44, 9/208, 7/67, 9/29, 8/154)
y<-1/(1/y+1)
z<-1/(1/z+1)
lkhd=function(a,b,y)
{
prob=1
for (i in 1:length(y)){
prob=prob/beta(a,b)*y[i]^(a-1)*(1-y[i])^(b-1)
}
prob
}
alpha=seq(0.1,20,0.1);na=length(alpha)
beta=seq(0.1,50,0.1);nb=length(beta)
prior=function(a,b)
{
u<-a/(a+b)
s2<-u*(1-u)/(a+b+1)
prob = 1*1/(u*(1-u))
}
#alpha=seq(0.1,100,0.1);na=length(alpha)
#beta=seq(0.1,100,0.1);nb=length(beta)
zy=matrix(0,na,nb)
for (i in 1:na){
zy[i,]=lkhd(alpha[i],beta,y)*prior(alpha[i],beta)
}
par(mfrow=c(1,2))
zy=zy/sum(zy*0.1*0.1)
contour(alpha,beta,zy, nlevels=10,
main="Contour plot of posterior Thetay",
xlim=c(0,10),ylim=c(0,40),xlab="alpha",ylab="beta")
alphaz=seq(0.1,20,0.1);na=length(alphaz)
betaz=seq(0.1,100,0.1);nb=length(betaz)
zz=matrix(0,na,nb)
for (i in 1:na){
zz[i,]=lkhd(alphaz[i],betaz,z)*prior(alphaz[i],betaz)
}
zz=zz/sum(zz*0.1*0.1)
contour(alphaz,betaz,zz, nlevels=10,
main="Contour plot of posterior Thetaz",
xlim=c(0,10),ylim=c(0,80),xlab="alpha",ylab="beta")
amary=NULL
for (i in 1:nrow(zy)){
amary=cbind(amary,sum(zy[i,])*0.1)}
amary<-amary/sum(amary*0.1)
simu=matrix(0,1000,2)
for (i in 1:1000){
a=sample(alpha,1,prob=amary)
b=sample(beta,1,prob=zy[which(alpha==a),]/sum(zy[which(alpha==a),]*0.1))
simu[i,]=c(a,b)
}
plot(simu[,2]~ simu[,1],
type="p",xlim=c(0,20),ylim=c(0,60),
xlab="alpha",ylab="beta",main = "Simulation of thetay")
amarz=NULL
for (i in 1:nrow(zz)){
amarz=cbind(amarz,sum(zz[i,])*0.1)}
amarz<-amarz/sum(amarz*0.1)
simu1=matrix(0,1000,2)
for (i in 1:1000){
a=sample(alphaz,1,prob=amarz)
b=sample(betaz,1,prob=zz[which(alphaz==a),]/sum(zz[which(alphaz==a),]*0.1))
simu1[i,]=c(a,b)
}
plot(simu1[,2]~ simu1[,1],
type="p",xlim=c(0,20),ylim=c(0,100),
xlab="alpha",ylab="beta",main = "Simulation of thetaz")
#(d)
uy<-simu[,1]/(simu[,1]+simu[,2])
uz<-simu1[,1]/(simu1[,1]+simu1[,2])
par(mfrow=c(1,1))
hist(uy-uz,breaks= 30)
#3
y<-c(16/58, 9/90, 10/48, 13/57, 19/103, 20/57, 18/86, 17/112, 35/273, 55/64)
z<-c(12/113, 1/18, 2/14, 4/44, 9/208, 7/67, 9/29, 8/154)
y<-1/(1/y+1)
z<-1/(1/z+1)
lkhd=function(a,b,y)
{
prob=1
for (i in 1:length(y)){
prob=prob/beta(a,b)*y[i]^(a-1)*(1-y[i])^(b-1)
}
prob
}
alpha=seq(0.1,50,0.1);na=length(alpha)
beta=seq(0.1,50,0.1);nb=length(beta)
prior=function(a,b)
{
u<-a/(a+b)
s2<-u*(1-u)/(a+b+1)
prob = 1*1/(u*(1-u))
}
#alpha=seq(0.1,100,0.1);na=length(alpha)
#beta=seq(0.1,100,0.1);nb=length(beta)
zy=matrix(0,na,nb)
for (i in 1:na){
zy[i,]=lkhd(alpha[i],beta,y)*prior(alpha[i],beta)
}
par(mfrow=c(1,2))
zy=zy/sum(zy*0.1*0.1)
contour(alpha,beta,zy, nlevels=10,
main="Contour plot of posterior Thetay",
xlim=c(0,10),ylim=c(0,40),xlab="alpha",ylab="beta")
alphaz=seq(0.1,50,0.1);na=length(alphaz)
betaz=seq(0.1,100,0.1);nb=length(betaz)
zz=matrix(0,na,nb)
for (i in 1:na){
zz[i,]=lkhd(alphaz[i],betaz,z)*prior(alphaz[i],betaz)
}
zz=zz/sum(zz*0.1*0.1)
contour(alphaz,betaz,zz, nlevels=10,
main="Contour plot of posterior Thetaz",
xlim=c(0,10),ylim=c(0,80),xlab="alpha",ylab="beta")
amary=NULL
for (i in 1:nrow(zy)){
amary=cbind(amary,sum(zy[i,])*0.1)}
amary<-amary/sum(amary*0.1)
simu=matrix(0,1000,2)
for (i in 1:1000){
a=sample(alpha,1,prob=amary)
b=sample(beta,1,prob=zy[which(alpha==a),]/sum(zy[which(alpha==a),]*0.1))
simu[i,]=c(a,b)
}
plot(simu[,2]~ simu[,1],
type="p",xlim=c(0,20),ylim=c(0,60),
xlab="alpha",ylab="beta",main = "Simulation of thetay")
amarz=NULL
for (i in 1:nrow(zz)){
amarz=cbind(amarz,sum(zz[i,])*0.1)}
amarz<-amarz/sum(amarz*0.1)
simu1=matrix(0,1000,2)
for (i in 1:1000){
a=sample(alphaz,1,prob=amarz)
b=sample(betaz,1,prob=zz[which(alphaz==a),]/sum(zz[which(alphaz==a),]*0.1))
simu1[i,]=c(a,b)
}
plot(simu1[,2]~ simu1[,1],
type="p",xlim=c(0,20),ylim=c(0,100),
xlab="alpha",ylab="beta",main = "Simulation of thetaz")
#(d)
uy<-simu[,1]/(simu[,1]+simu[,2])
uz<-simu1[,1]/(simu1[,1]+simu1[,2])
par(mfrow=c(1,1))
hist(uy-uz,breaks= 30)
library(RCurl)
web_page <- getURL("http://tycho.usno.navy.mil/cgi-bin/timer.pl")
library(RCurl)
web_page <- getURL("http://www.bloomberg.com/news/articles/2015-07-02/dupont-spins-off-chemicals-and-cleanup-liabilities-l")
web_page
library(XML)
page_tree <- htmlTreeParse(webpage)
library(XML)
page_tree <- htmlTreeParse(web_page)
page_tree
#2.b
xc<-rt(1000,df = 31)*sqrt(0.0075*29/31)+1.013
xt<-rt(1000,df = 35)*sqrt(0.2/36*33/35)+1.173
diff<-xt-xc
hist(diff,breaks = 20,main = "Histogram of the ut-uc")
>quantile(diff, c(.025, .975))
quantile(diff, c(.025, .975))
#2.b
xc<-rt(1000,df = 31)*sqrt(0.24^2/32*29/31)+1.013
xt<-rt(1000,df = 35)*sqrt(0.2^2/36*33/35)+1.173
diff<-xt-xc
hist(diff,breaks = 20,main = "Histogram of the ut-uc")
quantile(diff, c(.025, .975))
#2.b
xc<-rt(1000,df = 31)*sqrt(0.24^2/32)+1.013
xt<-rt(1000,df = 35)*sqrt(0.2^2/36)+1.173
diff<-xt-xc
hist(diff,breaks = 20,main = "Histogram of the ut-uc")
quantile(diff, c(.025, .975))
setwd("~/Documents/stat4249/project2-project2-group2/app")
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
shiny::runApp('app')
shiny::runApp('app')
shiny::runApp('app')
shiny::runApp('app')
plot(table(miceData$Date),ylab = "Mice number", col = "red", main = "Mice number according to Time")
load("miceData.RData")
setwd("~/Documents/stat4249/project2-project2-group2/data")
load("miceData.RData")
plot(table(miceData$Date),ylab = "Mice number", col = "red", main = "Mice number according to Time")
@@ -7,9 +6,18 @@ lines(lowess(table(miceData$Date)),type = "b", col = "yellow")
#This date x, y can be changed into costumized date
x <- as.Date("2011-09-10")
-y <- as.Date("2015-07-22")
+y <- as.Date("2012-07-22")
+miceData %>%
+  ggvis(~Date[Date<y&Date>x]) %>%
+  layer_histograms(width = input_numeric(label="Width",value=1)) %>%
+  add_axis("x", title = "Date") %>%
+  add_axis("y", title = "Mice Number")
library(leaflet) ; library(RColorBrewer) ; library(ggvis) ; library(DT)
x <- as.Date("2011-09-10")
y <- as.Date("2015-07-22")
miceData %>%
ggvis(~Date[Date<y&Date>x]) %>%
layer_histograms(width = input_numeric(label="Width",value=1)) %>%
add_axis("x", title = "Date") %>%
add_axis("y", title = "Mice Number")
miceData %>%
ggvis(~Date[Date<y&Date>x]) %>%
layer_histograms(width = input_numeric(label="Width",value=1)) %>%
add_axis("x", title = "Date") %>%
add_axis("y", title = "Mice Number")
shiny::runApp('~/Documents/stat4249/project2-project2-group2/app')
setwd("~/Documents/stat4249/project2-project2-group2/data")
load("zip.rating.RData")
zip.rating<-data.frame(zip.rating)
colnames(zip.rating)<-c("zipcode","2010","2011","2012","2013","2014","2015","2016","punishment","score")
setwd("~/Documents/stat4249/project2-project2-group2/data")
load("zip.rating.RData")
zip.rating<-data.frame(zip.rating)
zip.rating<-zip.rating[,-8]
colnames(zip.rating)<-c("zipcode","2010","2011","2012","2013","2014","2015","punishment","score")
View(zip.rating)
View(zip.rating)
zip.rating$"2010"<-as.numeric(as.character(zip.rating$"2010"))
zip.rating$"2011"<-as.numeric(as.character(zip.rating$"2011"))
zip.rating$"2012"<-as.numeric(as.character(zip.rating$"2012"))
zip.rating$"2013"<-as.numeric(as.character(zip.rating$"2013"))
zip.rating$"2014"<-as.numeric(as.character(zip.rating$"2014"))
zip.rating$"2015"<-as.numeric(as.character(zip.rating$"2015"))
save(zip.rating,file="zrating.RData")
shiny::runApp('~/Documents/stat4249/project2-project2-group2/app')
install.packages('devtools')
devtools::install_github('rstudio/rsconnect')
rsconnect::setAccountInfo(name='stat4249ratsinnewyork',
token='BBB89DAC7C0A94ECBFD3F712CAF084F6',
secret='<SECRET>')
library(rsconnect)
rsconnect::deployApp('~/Documents/stat4249/project2-project2-group2/')
rsconnect::setAccountInfo(name='stat4249ratsinnewyork',
token='BBB89DAC7C0A94ECBFD3F712CAF084F6',
secret='<SECRET>')
rsconnect::setAccountInfo(name='stat4249ratsinnewyork',
token='BBB89DAC7C0A94ECBFD3F712CAF084F6',
secret='<SECRET>')
rsconnect::setAccountInfo(name='stat4249ratsinnewyork',
token='BBB89DAC7C0A94ECBFD3F712CAF084F6',
secret='tcN5/yDiN5j4BuaAnR7E7OP0EyxpDJMe6kHQ6w6g')
library(rsconnect)
rsconnect::deployApp('~/Documents/stat4249/project2-project2-group2/')
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
deployApp()
deployApp("app")
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
library(shiny)
setwd("~/Documents/stat4249/project2-project2-group2/")
runApp("app")
getwd()
deployApp(appName="APP1")
getwd()
deployApp(appName="app")
shiny::runApp('app')
shiny::runApp('app')
runApp()
setwd("~/Documents/stat4249/project2-project2-group2/app")
runApp()
deployApp()
setwd("~/Documents/stat4249/project2-project2-group2/app123")
runApp()
runApp()
runApp()
install.packages("choroplethr")
library(choroplethr)
shiny::runApp()
install.packages( 'choroplethrZip')
shiny::runApp()
shiny::runApp()
shiny::runApp()
install_github('arilamstein/choroplethrZip@v1.3.0')
shiny::runApp()
shiny::runApp()
devtools::install_github("leaflet-shiny", "jcheng5")
shiny::runApp()
shiny::runApp()
library(leaflet)
library(shiny)
library(shinydashboard)
library(ggvis)
library(ggplot2)
x = c("leaflet","dplyr","data.table")
shiny::runApp()
detach("package:choroplethr", unload=TRUE)
remove.packages("leaflet-shiny")# "jcheng5")
